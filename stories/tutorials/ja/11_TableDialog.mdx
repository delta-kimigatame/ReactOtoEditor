import { Meta } from '@storybook/addon-docs/blocks';
import { EditorButton } from '../../../src/components/Editor/EditButton/EditorButton';
import TableViewIcon from '@mui/icons-material/TableView';

<Meta title="Tutorial/ja/11.パラメータ一覧と一括処理" />

# パラメータ一覧と一括処理

エディタ画面での基本的な編集方法は09で説明しました。
ここでは、すべてのエイリアスを一覧で確認できる「パラメータ一覧」と、全エイリアスをまとめて編集できる「一括処理」について説明します。

## パラメータ一覧を開く

画面下部のボタンエリアにある <EditorButton size={24} icon={<TableViewIcon sx={{ fontSize: 16 }} />} title="パラメータ一覧" onClick={() => {}} /> **パラメータ一覧ボタン**をタップします。

<iframe
  src="/iframe.html?id=components-tabledialog-tabledialog--opened&viewMode=story"
  style={{ width: '100%', height: '600px', border: '1px solid #ccc', pointerEvents: 'none' }}
  title="パラメータ一覧画面"
/>

## パラメータ一覧とは

エディタ画面では1つのエイリアスしか表示されませんが、パラメータ一覧では、すべてのエイリアスとそのパラメータを表形式で確認できます。

## 基本的な使い方

### エイリアスを選んで移動

移動したいエイリアスの行をタップすると、エディタ画面がそのエイリアスに切り替わります。

> 💡 **活用法**: パラメータ一覧で全体を眺めて、気になるエイリアスを見つけたら、その行をタップしてエディタ画面で詳しく確認できます。

## 一括処理機能

**全エイリアス**に対して、パラメータをまとめて調整できる機能です。

> ⚠️ **重要**: 一括処理は、**すべてのファイル・すべてのエイリアス**が対象になります。特定のエイリアスだけを選んで処理することはできません。

### 一括処理の開き方

画面上部にある**一括処理ボタン**をタップすると、一括処理画面が開きます。

### 一括処理の種類

一括処理には、以下の11種類があります：

#### 1. wavが存在しない行を削除

oto.iniには記載されていますが、実際のwavファイルが存在しないエイリアスを削除します。

> 💡 **活用法**: 他の音源のoto.iniを読み込んだときや、wavファイルを削除した後に、oto.iniをクリーンアップできます。

#### 2. データがないwavに対応する行を追加

wavファイルは存在しますが、oto.iniに記載がないものに対して、新しい行を追加します。

> 💡 **活用法**: 新しくwavファイルを追加したときや、他の音源のoto.iniを読み込んだときに、不足している行を補完できます。

#### 3. 重複エイリアスに連番を振る

同じエイリアス名が複数ある場合、自動的に連番を付けて区別します。
また、指定した数を超えるエイリアスは削除されます。

**入力項目:**
- 接尾辞: 連番の後ろに付ける文字（例: "強"、"C4"）
- 連番の数: 残すエイリアスの数（例: 3）

**仕組み:**
- 末尾の数字を連番とみなすと不都合があるため、指定した接尾辞を無視して連番を振ります
- 連番の数が0の場合は制限なく作成され、1以上の場合はその数まで残して削除されます

**使用例:**

強音源で[あ強]が3つある場合、接尾辞に"強"、連番の数に3を指定:
- [あ強]、[あ強]、[あ強] → [あ強]、[あ2強]、[あ3強]

C4音源で[か C4]が5つあるが3つだけ残したい場合、接尾辞に"C4"、連番の数に3を指定:
- [か C4]が5つ → [か C4]、[か2C4]、[か3C4]（残り2つは削除）

連続音で[- ん]が12個もあるが1つだけ残したい場合、接尾辞を空欄、連番の数に1を指定:
- [- ん]が12個 → [- ん]のみ残り、[- ん2]～[- ん12]は削除

> 💡 **活用法**: 連続音の録音では特定のエイリアス（[- ん]など）が大量に発生します。実際の音声合成では少数しか使わないため、この機能で不要なものをクリーンアップできます。

#### 4. 連番の数を制限する

すでに連番付きのエイリアスが存在する場合、指定した数を超えるものを削除します。

**入力項目:**
- 接尾辞: 連番の後ろに付いている文字（例: "強"、"C4"）
- 連番の数: 残すエイリアスの数（例: 3）

**仕組み:**
- 3番と同じルールで、指定した接尾辞を基準に連番を判断します
- すでに[あ強]、[あ2強]、[あ3強]、[あ4強]...のように連番が振られている前提で、指定した数より大きいものを削除します

**使用例:**

強音源で[あ強]～[あ5強]まであるが、3つまでに制限したい場合、接尾辞に"強"、連番の数に3を指定:
- [あ強]、[あ2強]、[あ3強]は残る
- [あ4強]、[あ5強]は削除される

> 💡 **活用法**: 3番の「重複エイリアスに連番を振る」を使った後、さらに数を調整したい場合や、すでに連番が振られている音源を整理する場合に便利です。

#### 5. 右ブランクを負の数にする

右ブランクを負の数の形式に変換します。

**右ブランクの2つの形式:**

- **正の数**: wavファイル末尾からの長さを表します（従来の形式）
- **負の数**: 先行発声からの長さの絶対値に負の記号を付けたものです（現代的な形式）

**負の数形式のメリット:**

09のチュートリアルで説明したように、原音設定は先行発声を中心に行います。
負の数形式では、先行発声を動かすと右ブランクも自動的に追随してくれます。
正の数形式では先行発声に追随しないため、編集の手間が増えます。

**使用例:**

従来の形式で作られた音源を読み込んで、編集しやすい形式に変換したい場合に使用します。

> 💡 **活用法**: 他の人が作った音源を引き継いで編集する場合や、古い形式の音源を現代的な編集スタイルに合わせたい場合に便利です。先行発声を調整するたびに右ブランクも手動で調整する手間がなくなります。

すべてのエイリアスのオーバーラップを、先行発声の1/3の値に設定します。

> 💡 **活用法**: 連続音やVCでは、オーバーラップは先行発声の1/3が基本です。この処理で一括設定できます。

#### 7. エイリアスの末尾を削除

エイリアス名の末尾から、指定した文字列を削除します。

**入力項目:**
- 削除する接尾辞: 削除したい文字列（例: "_強"、"_C4"）

**使用例:**
- [あ_強] → [あ]
- [か_C4] → [か]

> 💡 **活用法**: 既存の音源のoto.iniを別の音源用に流用したい場合に便利です。例えば、C4音源のoto.iniを読み込んでF4音源を作りたい時、まず7番で"_C4"を削除してから、8番で"_F4"を追加します。

#### 8. エイリアスの末尾に文字を追加

エイリアス名の末尾に、指定した文字列を追加します。

**入力項目:**
- 追加する接尾辞: 追加したい文字列（例: "_囁"、"_A3"）

**使用例:**
- [あ] → [あ_囁]
- [か] → [か_A3]

> 💡 **活用法**: 音高違いや音色違いの音源を作る際、既存のoto.iniを流用して新しい接尾辞を付けられます。7番と組み合わせることで、効率的に別バージョンの音源を作成できます。

#### 9. 指定パラメータの増減

指定したパラメータに、指定した値を加算します。

**入力項目:**
- パラメータ: 対象のパラメータ（左ブランク/オーバーラップ/先行発声/固定範囲/右ブランク）
- 値: 加算する値（ミリ秒）

**使用例:**
- すべての左ブランクを10ミリ秒遅らせる
- すべての先行発声を5ミリ秒早める（値を-5にする）

> 💡 **活用法**: ガイドBGMを使って録音した音源で、oto.iniを自動生成した場合、ガイドBGMのオフセット値が想定と異なると全エイリアスがずれてしまいます。この機能で一括補正できます。

#### 10. 指定パラメータの変更

指定したパラメータを、指定した値に設定します。

**入力項目:**
- パラメータ: 対象のパラメータ（左ブランク/オーバーラップ/先行発声/固定範囲/右ブランク）
- 値: 設定する値（ミリ秒）

**使用例:**
- すべてのオーバーラップを0にする
- すべての左ブランクを100にする

> 💡 **活用法**: ガイドBGMのbpmを間違えていた場合や、異なるbpmの音源からoto.iniを流用した場合に便利です。連続音では、先行発声・オーバーラップ・固定範囲・右ブランクはガイドBGMのbpmから機械的に計算できるため、この機能で一括設定できます。

#### 11. を/ぢ/づの補完

[お]のエイリアスがある場合、自動的に[を]のエイリアスを追加します。
同様に、[じ]→[ぢ]、[ず]→[づ]も補完します。
（すべて同じパラメータで複製）

連続音形式にも対応しており、[a お]→[a を]のような補完も行われます。

> 💡 **活用法**: 単独音や連続音音源で、同じ音で代用できる仮名を一括で追加できます。

> ⚠️ **使用タイミング**: この機能は**手作業での原音設定が終わった後、最後の仕上げ**に使うのがおすすめです。先に使ってしまうと、[お]と[を]の両方を手動で設定する羽目になり、二度手間になってしまいます。

## パラメータ一覧を使うタイミング

### こんな時に便利

**全体を確認したい:**
- 編集が終わった後、すべてのパラメータを一覧で確認したい
- 気になるエイリアスを見つけて、すぐにエディタ画面に移動したい

**他の音源からoto.iniを流用したい:**
- 存在しないwavファイルの行を削除したい（1番）
- 不足している行を追加したい（2番）
- 接尾辞を変更して別バージョンの音源を作りたい（7番・8番）
- 異なるbpmのoto.iniを調整したい（10番）

**エイリアスを整理したい:**
- 重複しているエイリアスに連番を振りたい（3番）
- 大量発生したエイリアスを制限したい（3番・4番）
- を/ぢ/づを補完したい（11番）

**パラメータを一括調整したい:**
- 自動生成したoto.iniのずれを補正したい（9番）
- オーバーラップを先行発声の1/3に設定したい（6番）
- 正の右ブランクを負の数形式に変換したい（5番）

## 注意事項

### 一括処理の取り消し

一括処理を実行すると、すぐに適用されます。

> ⚠️ **注意**: 現在、取り消し（元に戻す）機能はありません。

一括処理を実行する前に：
1. どのような処理が行われるか理解する
2. 入力する値が正しいか確認する
3. 不安な場合は、事前にダウンロードしてバックアップを取る

---

- 前のページ: [10.エイリアス編集画面](/docs/tutorial-ja-10-エイリアス編集画面--docs)
- 次のページ: [12.原音設定の基本パターン](/docs/tutorial-ja-12-原音設定の基本パターン--docs)
